{% extends "custom_admin/base.html" %}
{% block content %}
<div class="container my-5">
    <h2>Order #{{ order.order_code }}</h2>
    <p>User: {{ order.user.email }}</p>
    <p>Total: ₹{{ order.total_price }}</p>
    <p>Placed On: {{ order.created_at|date:"M d, Y " }}</p>
    {% if order.status == "cancelled" %}
        <p class="text-danger">Cancellation Reason: {{ order.cancellation_reason }}</p>
    {% endif %}

    <hr>
    <h4>Items</h4>
    <table class="table table-hover align-middle">
        <thead class="table-dark">
            <tr>
                <th>Product</th>
                <th>Variant</th>
                <th>Quantity</th>
                <th>Price</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody>
            {% for item in items %}
                <tr>
                    <td>{{ item.variant.product.name }}</td>
                    <td>{{ item.variant.color }} / {{ item.variant.size }}</td>
                    <td>{{ item.quantity }}</td>
                    <td>₹{{ item.price }}</td>
                    <td>
                        <form method="post" action="{% url 'admin_update_order_item_status' item.item_id %}">
                            {% csrf_token %}
                            <div class="input-group">
                                <select name="status" class="form-select form-select-sm">
                                    <option value="Pending" {% if item.status == "pending" %}selected{% endif %}>Pending</option>
                                    <option value="Shipped" {% if item.status == "shipped" %}selected{% endif %}>Shipped</option>
                                    <option value="Delivered" {% if item.status == "delivered" %}selected{% endif %}>Delivered</option>
                                    <option value="Cancelled" {% if item.status == "cancelled" %}selected{% endif %}>Cancelled</option>
                                </select>
                                <button type="submit" class="btn btn-sm btn-primary">Update</button>
                            </div>
                        </form>
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
