{% extends "user/base.html" %}
{% block title %} My Orders {% endblock title %}

{% block content %}
<script src="https://cdn.tailwindcss.com"></script>

<div class="max-w-4xl mx-auto py-10 px-4">

  <h2 class="text-2xl font-semibold mb-4">My Orders</h2>
  <hr class="mb-6 border-gray-300">

  <!-- Skeleton Loading -->
  <ul id="orders-skeleton" class="space-y-4">
    {% for _ in "1234567" %}
      <li class="h-12 bg-gray-300 rounded-lg animate-pulse"></li>
    {% endfor %}
  </ul>

  <!-- Real Orders List -->
  <ul id="orders-list" class="space-y-4 hidden">
    {% if page_obj %}
      {% for order in page_obj %}
      <li class="bg-white rounded-lg shadow p-4 flex justify-between items-center">
        <div class="flex-1">
          <span class="font-medium text-gray-700">#{{ order.order_code }}</span> 
          <span class="text-gray-500 ml-2">{{ order.created_at|date:"M d, Y" }}</span>
        </div>
        <span class="px-2 py-1 text-xs rounded 
        {% if order.status == 'delivered' %}bg-green-200 text-green-800
        {% elif order.status == 'pending' %}bg-yellow-200 text-yellow-800
        {% elif order.status == 'shipped' %}bg-blue-200 text-blue-800
        {% elif order.status == 'cancelled' %}bg-red-200 text-red-800
        {% else %}bg-gray-200 text-gray-800
        {% endif %}">
        {{ order.status|title }}
        </span>
          {{ order.status|title }}
        </span>
        <a href="{% url 'order_detail' order.order_id %}" class="ml-4 inline-block px-3 py-1 text-sm bg-blue-600 text-white rounded hover:bg-blue-700 transition">
          View
        </a>
      </li>
      {% endfor %}

      <!-- Pagination -->
      <nav class="mt-6 flex justify-center">
        <ul class="inline-flex space-x-1">
          {% if page_obj.has_previous %}
            <li>
              <a href="?page={{ page_obj.previous_page_number }}" class="px-3 py-1 border rounded hover:bg-gray-200">Previous</a>
            </li>
          {% else %}
            <li><span class="px-3 py-1 border rounded text-gray-400 cursor-not-allowed">Previous</span></li>
          {% endif %}

          {% for num in page_obj.paginator.page_range %}
            {% if page_obj.number == num %}
              <li><span class="px-3 py-1 border-b-2 border-blue-600 font-semibold">{{ num }}</span></li>
            {% elif num > page_obj.number|add:'-2' and num < page_obj.number|add:'2' %}
              <li><a href="?page={{ num }}" class="px-3 py-1 border rounded hover:bg-gray-200">{{ num }}</a></li>
            {% endif %}
          {% endfor %}

          {% if page_obj.has_next %}
            <li>
              <a href="?page={{ page_obj.next_page_number }}" class="px-3 py-1 border rounded hover:bg-gray-200">Next</a>
            </li>
          {% else %}
            <li><span class="px-3 py-1 border rounded text-gray-400 cursor-not-allowed">Next</span></li>
          {% endif %}
        </ul>
      </nav>

    {% else %}
      <div class="text-center text-gray-500 py-10 space-y-2">
        <i class="bi bi-emoji-frown text-5xl"></i>
        <p class="text-lg">You havenâ€™t placed any orders yet.</p>
      </div>
    {% endif %}
  </ul>
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    setTimeout(() => {
      document.getElementById('orders-skeleton').style.display = 'none';
      document.getElementById('orders-list').classList.remove('hidden');
    }, 1000); // simulate loading
  });
</script>

{% endblock %}
